<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auth0 Authentication</title>
    <script src="https://cdn.auth0.com/js/auth0/9.19/auth0.min.js"></script>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/OxyX1/oxyum-css@3a324169cae2d1506e174dd1a96efe79fd7c9302/oxyum.css">
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/OxyX1/oxyum-css@main/oxy.png" type="image/x-icon">
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
        }
    </style>
</head>

<body>
    <center><br><br><br><br><br>
        <h1>oxyum homes</h1>
        <p>a messaging software created by oxyum networks.</p><br><br>

        <button id="login">Login</button><br>
        <button id="logout" style="display: none;">Logout</button>
    </center>

    <script>
        const auth0Client = new auth0.WebAuth({
            domain: "dev-yvvarvk8mw7tss4s.us.auth0.com",
            clientID: "oFTiu6lvvfn50vFrGUhYmiriu3JoITGs",
            redirectUri: "http://shortline.proxy.rlwy.net:16258",
            responseType: "token id_token",
            scope: "openid profile email"
        });

        document.getElementById("login").addEventListener("click", function () {
            auth0Client.authorize({
                prompt: "login"
            });
        });

        document.getElementById("logout").addEventListener("click", function () {
            localStorage.removeItem("id_token");
            window.location.href = "/";
        });

        function handleAuthCallback() {
            auth0Client.parseHash((err, authResult) => {
                if (authResult && authResult.idToken) {
                    localStorage.setItem("id_token", authResult.idToken);
                    displayToken(authResult.idToken);
                }
            });
        }

        function displayToken(token) {
            document.getElementById("token").textContent = token;
            document.getElementById("login").style.display = "none";
            document.getElementById("logout").style.display = "inline";
        }

        const storedToken = localStorage.getItem("id_token");
        if (storedToken) {
            displayToken(storedToken);
        } else {
            handleAuthCallback();
        }
    </script>
</body>

</html>